"0","# load fire data"
"0","fire <- fread(paste0(idir, ""Data/MODIS_fire_2003-2020.csv""))"
"0",""
"0","# trend detection"
"0","mk.test(fire$frp)"
"1","
"
"1","	Mann-Kendall trend test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","fire$frp"
"1",""
"1","
"
"1","z = -2.8787, n = 18, p-value = 0.003993"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","S"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","sample estimates:
"
"1","         S "
"1","      varS "
"1","       tau "
"1","
"
"1","-77.000000 "
"1","697.000000 "
"1"," -0.503268 "
"1","
"
"1","
"
"0","mk.test(fire$count)"
"1","
"
"1","	Mann-Kendall trend test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","fire$count"
"1",""
"1","
"
"1","z = -3.106, n = 18, p-value = 0.001897"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","S"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","sample estimates:
"
"1","          S "
"1","       varS "
"1","        tau "
"1","
"
"1","-83.0000000 "
"1","697.0000000 "
"1"," -0.5424837 "
"1","
"
"1","
"
"0","# draw"
"0","lm_c <- lm(formula = count/count[1] ~ x, data = fire)"
"0","ci_c <- confint(lm_c, 'x', 0.95)"
"0","format(lm_c$coefficients[2]*100, digits=2)"
"1","      x "
"1","
"
"1","""-0.87"" "
"1","
"
"0","format((lm_c$coefficients[2]-ci_c[1])*100, digits = 1)"
"1","    x "
"1","
"
"1","""0.4"" "
"1","
"
"0","lm_f <- lm(formula = frp/frp[1] ~ x, data = fire)"
"0","ci_f <- confint(lm_f, 'x', 0.95)"
"0","format(lm_f$coefficients[2]*100, digits=2)"
"1","   x "
"1","
"
"1","""-1"" "
"1","
"
"0","format((lm_f$coefficients[2]-ci_f[1])*100, digits = 1)"
"1","    x "
"1","
"
"1","""0.6"" "
"1","
"
"0","p_f <- ggplot(fire) +"
"0","  geom_line(aes(x = x, y = count/100000, group = 1), color = ""#66c2a5"", alpha = 0.8, linewidth = 0.4) +"
"0","  geom_line(aes(x = x, y = frp/40/100000, group = 1), color =  ""#fc8d62"", alpha = 0.8, linewidth = 0.4) +"
"0","  geom_smooth(aes(x = x, y = count/100000, group = 1), color = ""#66c2a5"", method = lm, linetype = 'dashed', fill = '#e5f5e0', linewidth = 0.6) +"
"0","  geom_smooth(aes(x = x, y = frp/40/100000, group = 1), color =  ""#fc8d62"", method = lm, linetype = 'dashed', fill = '#fee0d2', linewidth = 0.6) +"
"0","  theme_bw() +"
"0","  annotate(""text"", 10, 41.8, label = expression('Fire count -0.87' %+-% '0.39% year' ^ {-1}), color = ""#66c2a5"", size = 2) +"
"0","  annotate(""text"", 16, 58, label = expression('FRP -1.01' %+-% '0.56% year' ^ {-1}), color = ""#fc8d62"", size = 2) +"
"0","  scale_y_continuous(labels = comma, n.breaks = 5, "
"0","                     name = expression('Fire count ('%*% 10 ^ {5} ~')'), "
"0","                     sec.axis = sec_axis(~.*40, name = expression(sum(FRP) ~ '('%*% 10 ^ {5} ~'MW)'), labels = comma)) +"
"0","  geom_vline(xintercept = 4, color = '#636363', linetype = 'dashed', linewidth = 0.2) +"
"0","  scale_x_continuous(limits = c(1, 21), breaks = c(1, 4, 11, 21), labels = c('2000', '2003', '2010', '2020')) +"
"0","  theme(aspect.ratio = 0.8,"
"0","        axis.title.y.left = element_text(color = ""#66c2a5"", size = 7),"
"0","        axis.title.y.right = element_text(color = ""#fc8d62"", size = 7, angle = 90),"
"0","        axis.text.y.left = element_text(color = ""#66c2a5"", size = 6, angle = 90, hjust = 0.5),"
"0","        axis.text.y.right = element_text(color = ""#fc8d62"", size = 6, angle = 90, hjust = 0.5),"
"0","        axis.line.y.left = element_line(color = ""#66c2a5""),"
"0","        axis.line.y.right = element_line(color = ""#fc8d62""),"
"0","        axis.ticks.y.left = element_line(color = ""#66c2a5""),"
"0","        axis.ticks.y.right = element_line(color = ""#fc8d62""),"
"0","        axis.line = element_line(linewidth = 0.2),"
"0","        axis.ticks = element_line(linewidth = 0.3),"
"0","        axis.title.x = element_blank(),"
"0","        axis.text.x = element_text(size = 7),"
"0","        plot.title = element_text(hjust = 0.5),"
"0","        title = element_text(size = 7),"
"0","        panel.grid.major = element_blank(),"
"0","        panel.grid.minor = element_blank()"
"0","  )"

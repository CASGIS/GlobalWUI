"0","# load data"
"0","era5 <- fread(paste0(idir, ""Data/ERA5_maxT_FWI_2000-2020.csv""))"
"0",""
"0","# trend detection"
"0","mk.test(era5$fwi)"
"1","
"
"1","	Mann-Kendall trend test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","era5$fwi"
"1",""
"1","
"
"1","z = 3.2311, n = 21, p-value = 0.001233"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","S"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","sample estimates:
"
"1","           S "
"1","        varS "
"1","         tau "
"1","
"
"1"," 108.0000000 "
"1","1096.6666667 "
"1","   0.5142857 "
"1","
"
"1","
"
"0","mk.test(era5$maxTemp)"
"1","
"
"1","	Mann-Kendall trend test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","era5$maxTemp"
"1",""
"1","
"
"1","z = 4.2578, n = 21, p-value = 2.065e-05"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","S"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","sample estimates:
"
"1","           S "
"1","        varS "
"1","         tau "
"1","
"
"1"," 142.0000000 "
"1","1096.6666667 "
"1","   0.6761905 "
"1","
"
"1","
"
"0","# draw"
"0","lm_f <- lm(formula = fwi/fwi[1] ~ x, data = era5)"
"0","ci_f <- confint(lm_f, 'x', 0.95)"
"0","format(lm_f$coefficients[2]*100, digits=2)"
"1","     x "
"1","
"
"1","""0.28"" "
"1","
"
"0","format((lm_f$coefficients[2]-ci_f[1])*100, digits = 2)"
"1","     x "
"1","
"
"1","""0.14"" "
"1","
"
"0","lm_t <- lm(formula = maxTemp/maxTemp[1] ~ x, data = era5)"
"0","ci_t <- confint(lm_t, 'x', 0.95)"
"0","format(lm_t$coefficients[2]*100, digits=2)"
"1","     x "
"1","
"
"1","""0.35"" "
"1","
"
"0","format((lm_t$coefficients[2]-ci_t[1])*100, digits = 2)"
"1","     x "
"1","
"
"1","""0.11"" "
"1","
"
"0","p_fr <- ggplot(era5) +"
"0","  geom_line(aes(x = x, y = fwi), color = '#54278f', alpha = 0.8, linewidth = 0.4) +"
"0","  geom_smooth(aes(x = x, y = fwi, group = 1), color = '#54278f', method = lm, linetype = 'dashed', fill = '#dadaeb', linewidth = 0.6) +"
"0","  geom_line(aes(x = x, y = maxTemp*1.1), color = '#cb181d', alpha = 0.8, linewidth = 0.4) +"
"0","  geom_smooth(aes(x = x, y = maxTemp*1.1, group = 1), color = '#cb181d', method = lm, linetype = 'dashed', fill = '#fee0d2', linewidth = 0.6) +"
"0","  theme_bw()  +"
"0","  annotate(""text"", 8, 16.9, label = expression(FWI ~ 0.28 %+-% '0.14% year' ^ {-1}), color = '#54278f', size = 2) +"
"0","  annotate(""text"", 12.2, 14.8, label = expression(Max ~ temperature ~ 0.35 %+-% '0.11% year' ^ {-1}), color = '#cb181d', size = 2) +"
"0","  scale_y_continuous(expand = c(0,0), labels = comma, n.breaks = 5, "
"0","                     name = 'Fire Weather Index',"
"0","                     sec.axis = sec_axis(~./1.1, name = 'Max temperature (Â°C)', labels = comma)) +"
"0","  scale_x_continuous(limits = c(1, 21), breaks = c(1, 11, 21), labels = c('2000', '2010', '2020')) +"
"0","  theme(aspect.ratio = 0.8,"
"0","        axis.title.y.left = element_text(color = '#54278f', size = 7),"
"0","        axis.title.y.right = element_text(color = ""#cb181d"", size = 7, angle = 90),"
"0","        axis.text.y.left = element_text(color = '#54278f', size = 6, angle = 90, hjust = 0.5),"
"0","        axis.text.y.right = element_text(color = ""#cb181d"", size = 6, angle = 90, hjust = 0.5),"
"0","        axis.line.y.left = element_line(color = ""#54278f""),"
"0","        axis.ticks.y.left = element_line(color = ""#54278f""),"
"0","        axis.line.y.right = element_line(color = ""#cb181d""),"
"0","        axis.ticks.y.right = element_line(color = ""#cb181d""),"
"0","        axis.line = element_line(linewidth = 0.2),"
"0","        axis.ticks = element_line(linewidth = 0.3),"
"0","        axis.title.x = element_blank(),"
"0","        axis.text.x = element_text(size = 7),"
"0","        plot.title = element_text(hjust = 0.5),"
"0","        title = element_text(size = 7),"
"0","        panel.grid.major = element_blank(),"
"0","        panel.grid.minor = element_blank()"
"0","  ) "
